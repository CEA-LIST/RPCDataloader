Search.setIndex({"docnames": ["api", "examples", "index"], "filenames": ["api.rst", "examples.rst", "index.rst"], "titles": ["API documentation", "Examples", "RPC Dataloader"], "terms": {"class": 0, "rpcdataload": [0, 1, 2], "dataset": [0, 1, 2], "rpcdataset": [0, 1, 2], "batch_siz": [0, 1, 2], "1": [0, 1], "shuffl": [0, 2], "fals": 0, "sampler": [0, 1], "none": 0, "batch_sampl": 0, "collate_fn": 0, "pin_memori": [0, 1, 2], "drop_last": 0, "timeout": 0, "120": 0, "prefetch_factor": 0, "int": [0, 1], "2": [0, 1, 2], "sourc": [0, 1], "A": 0, "dataload": 0, "us": [0, 1, 2], "remot": [0, 2], "rpc": 0, "base": 0, "worker": [0, 1, 2], "paramet": [0, 1], "how": [0, 1], "mani": 0, "sampl": [0, 1], "per": [0, 1], "batch": [0, 1], "load": [0, 1], "set": 0, "true": [0, 1, 2], "have": 0, "data": [0, 1, 2], "reshuffl": 0, "everi": 0, "epoch": [0, 1], "defin": 0, "strategi": 0, "draw": 0, "from": [0, 1, 2], "can": 0, "ani": 0, "iter": 0, "__len__": 0, "implement": [0, 2], "If": 0, "specifi": 0, "must": 0, "like": 0, "return": [0, 2], "indic": 0, "time": [0, 1], "mutual": 0, "exclus": [0, 1], "merg": 0, "list": 0, "form": 0, "mini": 0, "tensor": 0, "": 0, "when": 0, "map": 0, "style": 0, "loader": [0, 2], "copi": 0, "cuda": [0, 1], "pin": 0, "memori": 0, "befor": 0, "them": 0, "your": 0, "element": 0, "ar": [0, 1], "custom": 0, "type": [0, 1], "i": [0, 1, 2], "see": 0, "exampl": [0, 2], "below": [0, 1], "drop": 0, "last": 0, "incomplet": 0, "size": [0, 1], "divis": 0, "smaller": 0, "number": [0, 1], "advanc": 0, "each": 0, "mean": [0, 1], "total": 0, "num_work": 0, "prefetch": 0, "across": 0, "all": 0, "default": [0, 1], "notabl": 0, "differ": 0, "pytorch": [0, 2], "individu": 0, "network": 0, "oper": 0, "worker_init_fn": 0, "gener": 0, "support": [0, 1], "random": 0, "seed": 0, "becaus": 0, "mai": 0, "execut": 0, "request": [0, 2], "out": 0, "order": 0, "anywai": 0, "thu": 0, "break": 0, "reproduc": 0, "str": [0, 1], "callabl": 0, "arg": [0, 1, 2], "kwarg": 0, "handl": 0, "instanci": 0, "manag": 0, "format": 0, "host": [0, 1, 2], "port": [0, 1, 2], "equival": 0, "instanc": 0, "posit": 0, "argument": 0, "keyword": 0, "In": 0, "distribut": [0, 1, 2], "setup": 0, "you": [0, 1], "should": [0, 1], "probabl": 0, "split": [0, 1], "between": [0, 1], "trainer": 0, "ie": 0, "rank": [0, 1], "world_siz": [0, 1], "rpc_async": 0, "func": 0, "_t": 0, "rref": 0, "bool": 0, "0": [0, 1, 2], "futur": 0, "function": [0, 1], "result": 0, "keword": 0, "wether": 0, "buffer": 0, "alloc": 0, "whether": 0, "output": 0, "refer": 0, "second": 0, "contain": 0, "valu": [0, 2], "its": [0, 2], "serializ": 0, "which": [0, 2], "exlud": 0, "usag": 0, "lambda": 0, "local": 0, "run_work": [0, 2], "float": [0, 1], "parallel": [0, 1], "start": [0, 1, 2], "listen": 0, "process": [0, 1], "procedur": [0, 2], "call": [0, 2], "interfac": 0, "bind": 0, "transfer": 0, "client": 0, "max": 0, "concurr": 0, "The": [0, 1, 2], "neither": 0, "authent": 0, "nor": 0, "encrypt": 0, "user": [0, 1], "send": 0, "arbitrari": 0, "command": [0, 2], "traffic": 0, "separ": 0, "thread": 0, "overlap": 0, "regardless": 0, "set_random_se": 0, "base_se": 0, "worker_id": 0, "python": [0, 1, 2], "torch": [0, 1, 2], "numpi": 0, "thi": [0, 1, 2], "onc": 0, "note": [0, 1], "run": [0, 1, 2], "task": [0, 1], "so": 0, "doe": [0, 2], "ensur": 0, "onli": 0, "non": 0, "redund": 0, "randint": 0, "32": 0, "item": [0, 1, 2], "enumer": [0, 1], "resnet50": 1, "It": [1, 2], "mix": 1, "precis": 1, "modif": 1, "make": 1, "highlight": 1, "evalu": 1, "routin": 1, "ommit": 1, "readabl": 1, "prior": 1, "script": [1, 2], "spawn": 1, "import": 1, "argpars": 1, "o": 1, "nn": 1, "optim": 1, "lr_schedul": 1, "steplr": 1, "util": 1, "distributedsampl": 1, "randomsampl": 1, "torchvis": [1, 2], "transform": [1, 2], "imagefold": [1, 2], "model": 1, "get_model": 1, "def": 1, "main": [1, 2], "argumentpars": 1, "add_argu": 1, "path": 1, "narg": 1, "lr": 1, "momentum": 1, "9": 1, "weight": 1, "decai": 1, "1e": 1, "4": 1, "100": 1, "amp": 1, "action": 1, "store_tru": 1, "parse_arg": 1, "environ": 1, "torchrun": 1, "launch": [1, 2], "local_rank": 1, "elif": 1, "get": 1, "slurm_nproc": 1, "srun": 1, "slurm_procid": 1, "slurm_localid": 1, "els": 1, "singl": 1, "gpu": 1, "init_process_group": 1, "backend": 1, "nccl": 1, "option": 1, "recommend": 1, "len": 1, "print": 1, "devic": 1, "index": 1, "preprocess": 1, "normal": 1, "485": 1, "456": 1, "406": 1, "std": 1, "229": 1, "224": 1, "225": 1, "train_transform": [1, 2], "compos": 1, "randomresizedcrop": 1, "randaug": 1, "totensor": 1, "train_dataset": 1, "root": [1, 2], "data_path": [1, 2], "is_initi": 1, "train_sampl": 1, "train_load": 1, "num_class": 1, "1000": 1, "syncbatchnorm": 1, "convert_sync_batchnorm": 1, "distributeddataparallel": 1, "device_id": 1, "sgd": 1, "weight_decai": 1, "scaler": 1, "gradscal": 1, "enabl": 1, "schedul": 1, "step_siz": 1, "30": 1, "gamma": 1, "loss_fn": 1, "crossentropyloss": 1, "rang": 1, "isinst": 1, "set_epoch": 1, "imag": 1, "target": 1, "t0": 1, "monoton": 1, "zero_grad": 1, "set_to_non": 1, "non_block": 1, "autocast": 1, "predict": 1, "loss": 1, "scale": 1, "backward": 1, "step": 1, "updat": 1, "20": 1, "t1": 1, "f": 1, "3d": 1, "5d": 1, "3f": 1, "1f": 1, "__name__": 1, "__main__": 1, "To": [1, 2], "cluster": 1, "heterogen": 1, "job": 1, "let": 1, "reserv": 1, "two": 1, "group": 1, "resourc": 1, "one": [1, 2], "demonstr": 1, "do": 1, "might": 1, "need": 1, "adjust": 1, "avoid": 1, "collis": 1, "also": 1, "specif": 1, "depend": 1, "configur": 1, "usr": 1, "bin": 1, "env": 1, "sh": 1, "sbatch": 1, "01": 1, "00": 1, "specfif": 1, "partit": 1, "prismgpup": 1, "node": 1, "ntask": 1, "cpu": 1, "mem": 1, "96g": 1, "gre": 1, "hetjob": 1, "10": 1, "40g": 1, "miniconda3": 1, "etc": 1, "profil": 1, "d": 1, "conda": 1, "activ": 1, "export": 1, "ld_library_path": 1, "home": 1, "ngranger": 1, "sysroot": 1, "lib64": 1, "rpc_port_start": 1, "16000": 1, "identifi": 1, "tmpfile": 1, "tmpdir": 1, "tmp": 1, "rpcdataloader_work": 1, "slurm_job_id": 1, "het": 1, "kill": 1, "bad": 1, "exit": 1, "c": 1, "echo": 1, "hostnam": 1, "ib": 1, "readarrai": 1, "t": 1, "rm": 1, "background": 1, "u": 1, "m": [1, 2], "worker_task_pid": 1, "master_addr": 1, "scontrol": 1, "show": 1, "slurm_job_nodelist_het_group_0": 1, "head": 1, "n": 1, "master_port": 1, "17000": 1, "example_rpc": 1, "py": 1, "media": 1, "ilsvrc": 1, "swin_v2_": 1, "256": 1, "001": 1, "stop": 1, "librari": 2, "variant": 2, "allow": 2, "over": 2, "server": 2, "rather": 2, "than": 2, "sever": 2, "daemon": 2, "comput": 2, "machin": 2, "dispatch": 2, "await": 2, "though": 2, "similar": 2, "own": 2, "simpler": 2, "initi": 2, "conflict": 2, "pip": 2, "few": 2, "either": 2, "line": 2, "6543": 2, "directli": 2, "Then": 2, "instanti": 2, "node01": 2, "node02": 2, "5432": 2, "train": 2, "minibatch": 2, "api": 2, "document": 2, "imagenet": 2, "slurm": 2, "integr": 2}, "objects": {"": [[0, 0, 0, "-", "rpcdataloader"]], "rpcdataloader": [[0, 1, 1, "", "RPCDataloader"], [0, 1, 1, "", "RPCDataset"], [0, 2, 1, "", "rpc_async"], [0, 2, 1, "", "run_worker"], [0, 2, 1, "", "set_random_seeds"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:function"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "function", "Python function"]}, "titleterms": {"api": 0, "document": 0, "exampl": 1, "imagenet": 1, "train": 1, "slurm": 1, "integr": 1, "rpc": 2, "dataload": 2, "instal": 2, "usag": 2, "further": 2, "read": 2}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx": 57}, "alltitles": {"API documentation": [[0, "module-rpcdataloader"]], "Examples": [[1, "examples"]], "ImageNet training example": [[1, "imagenet-training-example"]], "Slurm integration example": [[1, "slurm-integration-example"]], "RPC Dataloader": [[2, "rpc-dataloader"]], "Installation": [[2, "installation"]], "Usage": [[2, "usage"]], "Further reading": [[2, "further-reading"]]}, "indexentries": {"rpcdataloader (class in rpcdataloader)": [[0, "rpcdataloader.RPCDataloader"]], "rpcdataset (class in rpcdataloader)": [[0, "rpcdataloader.RPCDataset"]], "module": [[0, "module-rpcdataloader"]], "rpc_async() (in module rpcdataloader)": [[0, "rpcdataloader.rpc_async"]], "rpcdataloader": [[0, "module-rpcdataloader"]], "run_worker() (in module rpcdataloader)": [[0, "rpcdataloader.run_worker"]], "set_random_seeds() (in module rpcdataloader)": [[0, "rpcdataloader.set_random_seeds"]]}})